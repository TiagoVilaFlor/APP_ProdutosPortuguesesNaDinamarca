module.exports=[18622,(a,b,c)=>{b.exports=a.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},42602,(a,b,c)=>{"use strict";b.exports=a.r(18622)},87924,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].ReactJsxRuntime},72131,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].React},9270,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.AppRouterContext},38783,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].ReactServerDOMTurbopackClient},74477,(a,b,c)=>{"use strict";var d=a.r(72131);d.useState,d.useEffect,d.useLayoutEffect,d.useDebugValue,c.useSyncExternalStore=void 0!==d.useSyncExternalStore?d.useSyncExternalStore:function(a,b){return b()}},87610,(a,b,c)=>{"use strict";b.exports=a.r(74477)},56784,(a,b,c)=>{"use strict";var d=a.r(72131),e=a.r(87610),f="function"==typeof Object.is?Object.is:function(a,b){return a===b&&(0!==a||1/a==1/b)||a!=a&&b!=b},g=e.useSyncExternalStore,h=d.useRef,i=d.useEffect,j=d.useMemo,k=d.useDebugValue;c.useSyncExternalStoreWithSelector=function(a,b,c,d,e){var l=h(null);if(null===l.current){var m={hasValue:!1,value:null};l.current=m}else m=l.current;var n=g(a,(l=j(function(){function a(a){if(!i){if(i=!0,g=a,a=d(a),void 0!==e&&m.hasValue){var b=m.value;if(e(b,a))return h=b}return h=a}if(b=h,f(g,a))return b;var c=d(a);return void 0!==e&&e(b,c)?b:(g=a,h=c)}var g,h,i=!1,j=void 0===c?null:c;return[function(){return a(b())},null===j?void 0:function(){return a(j())}]},[b,c,d,e]))[0],l[1]);return i(function(){m.hasValue=!0,m.value=n},[n]),k(n),n}},64442,(a,b,c)=>{"use strict";b.exports=a.r(56784)},42463,8209,a=>{"use strict";a.s(["BOX_CAPACITY_LITERS",0,20,"SHIPPING_EUR_PER_BOX",0,20,"formatEur",0,a=>new Intl.NumberFormat("pt-PT",{style:"currency",currency:"EUR"}).format(a)],42463);let b={get url(){return`file://${a.P("node_modules/zustand/esm/vanilla.mjs")}`}},c=a=>{let c,d=new Set,e=(a,b)=>{let e="function"==typeof a?a(c):a;if(!Object.is(e,c)){let a=c;c=(null!=b?b:"object"!=typeof e||null===e)?e:Object.assign({},c,e),d.forEach(b=>b(c,a))}},f=()=>c,g={setState:e,getState:f,getInitialState:()=>h,subscribe:a=>(d.add(a),()=>d.delete(a)),destroy:()=>{(b.env?b.env.MODE:void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),d.clear()}},h=c=a(e,f,g);return g};var d=a.i(72131),e=a.i(64442);let f={get url(){return`file://${a.P("node_modules/zustand/esm/index.mjs")}`}},{useDebugValue:g}=d.default,{useSyncExternalStoreWithSelector:h}=e.default,i=!1,j={get url(){return`file://${a.P("node_modules/zustand/esm/middleware.mjs")}`}},k=a=>b=>{try{let c=a(b);if(c instanceof Promise)return c;return{then:a=>k(a)(c),catch(a){return this}}}catch(a){return{then(a){return this},catch:b=>k(b)(a)}}},l=(a=>{(f.env?f.env.MODE:void 0)!=="production"&&"function"!=typeof a&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");let b="function"==typeof a?a?c(a):c:a,d=(a,c)=>(function(a,b=a=>a,c){(f.env?f.env.MODE:void 0)!=="production"&&c&&!i&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),i=!0);let d=h(a.subscribe,a.getState,a.getServerState||a.getInitialState,b,c);return g(d),d})(b,a,c);return Object.assign(d,b),d})(((a,b)=>{if("getStorage"in b||"serialize"in b||"deserialize"in b)return(j.env?j.env.MODE:void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),(c,d,e)=>{let f,g,h={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:a=>a,version:0,merge:(a,b)=>({...b,...a}),...b},i=!1,j=new Set,l=new Set;try{f=h.getStorage()}catch(a){}if(!f)return a((...a)=>{console.warn(`[zustand persist middleware] Unable to update item '${h.name}', the given storage is currently unavailable.`),c(...a)},d,e);let m=k(h.serialize),n=()=>{let a,b=m({state:h.partialize({...d()}),version:h.version}).then(a=>f.setItem(h.name,a)).catch(b=>{a=b});if(a)throw a;return b},o=e.setState;e.setState=(a,b)=>{o(a,b),n()};let p=a((...a)=>{c(...a),n()},d,e),q=()=>{var a;if(!f)return;i=!1,j.forEach(a=>a(d()));let b=(null==(a=h.onRehydrateStorage)?void 0:a.call(h,d()))||void 0;return k(f.getItem.bind(f))(h.name).then(a=>{if(a)return h.deserialize(a)}).then(a=>{if(a)if("number"!=typeof a.version||a.version===h.version)return a.state;else{if(h.migrate)return h.migrate(a.state,a.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}}).then(a=>{var b;return c(g=h.merge(a,null!=(b=d())?b:p),!0),n()}).then(()=>{null==b||b(g,void 0),i=!0,l.forEach(a=>a(g))}).catch(a=>{null==b||b(void 0,a)})};return e.persist={setOptions:a=>{h={...h,...a},a.getStorage&&(f=a.getStorage())},clearStorage:()=>{null==f||f.removeItem(h.name)},getOptions:()=>h,rehydrate:()=>q(),hasHydrated:()=>i,onHydrate:a=>(j.add(a),()=>{j.delete(a)}),onFinishHydration:a=>(l.add(a),()=>{l.delete(a)})},q(),g||p};return(c,d,e)=>{let f,g={storage:function(a,b){let c;try{c=a()}catch(a){return}return{getItem:a=>{var b;let d=a=>null===a?null:JSON.parse(a,void 0),e=null!=(b=c.getItem(a))?b:null;return e instanceof Promise?e.then(d):d(e)},setItem:(a,b)=>c.setItem(a,JSON.stringify(b,void 0)),removeItem:a=>c.removeItem(a)}}(()=>localStorage),partialize:a=>a,version:0,merge:(a,b)=>({...b,...a}),...b},h=!1,i=new Set,j=new Set,l=g.storage;if(!l)return a((...a)=>{console.warn(`[zustand persist middleware] Unable to update item '${g.name}', the given storage is currently unavailable.`),c(...a)},d,e);let m=()=>{let a=g.partialize({...d()});return l.setItem(g.name,{state:a,version:g.version})},n=e.setState;e.setState=(a,b)=>{n(a,b),m()};let o=a((...a)=>{c(...a),m()},d,e);e.getInitialState=()=>o;let p=()=>{var a,b;if(!l)return;h=!1,i.forEach(a=>{var b;return a(null!=(b=d())?b:o)});let e=(null==(b=g.onRehydrateStorage)?void 0:b.call(g,null!=(a=d())?a:o))||void 0;return k(l.getItem.bind(l))(g.name).then(a=>{if(a)if("number"!=typeof a.version||a.version===g.version)return a.state;else{if(g.migrate)return g.migrate(a.state,a.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}}).then(a=>{var b;return c(f=g.merge(a,null!=(b=d())?b:o),!0),m()}).then(()=>{null==e||e(f,void 0),f=d(),h=!0,j.forEach(a=>a(f))}).catch(a=>{null==e||e(void 0,a)})};return e.persist={setOptions:a=>{g={...g,...a},a.storage&&(l=a.storage)},clearStorage:()=>{null==l||l.removeItem(g.name)},getOptions:()=>g,rehydrate:()=>p(),hasHydrated:()=>h,onHydrate:a=>(i.add(a),()=>{i.delete(a)}),onFinishHydration:a=>(j.add(a),()=>{j.delete(a)})},g.skipHydration||p(),f||o}})((a,b)=>({lines:[],wantsTransport:!1,add:b=>a(a=>a.lines.find(a=>a.itemId===b.itemId)?{lines:a.lines.map(a=>a.itemId===b.itemId?{...a,qty:a.qty+1}:a)}:{lines:[...a.lines,{...b,qty:1}]}),setQty:(b,c)=>a(a=>({lines:c<=0?a.lines.filter(a=>a.itemId!==b):a.lines.map(a=>a.itemId===b?{...a,qty:c}:a)})),remove:b=>a(a=>({lines:a.lines.filter(a=>a.itemId!==b)})),clear:()=>a({lines:[],wantsTransport:!1}),setWantsTransport:b=>a({wantsTransport:b}),totalItems:()=>b().lines.reduce((a,b)=>a+b.qty,0),subtotalEur:()=>b().lines.reduce((a,b)=>a+b.priceEur*b.qty,0),totalLiters:()=>b().lines.reduce((a,b)=>a+(b.volumeLiters??0)*b.qty,0),boxesNeeded:()=>{let a=b().totalLiters();return a<=0?0:Math.ceil(a/20)},transportEur:()=>b().wantsTransport?20*b().boxesNeeded():0,totalEur:()=>b().subtotalEur()+20}),{name:"tdl-cart-eur-gsheets-v1"}));a.s(["useCart",0,l],8209)},3967,a=>{"use strict";var b=a.i(87924),c=a.i(38246),d=a.i(72131),e=a.i(42463);function f({title:a,open:c,onToggle:d,children:e,anchorId:f}){return(0,b.jsxs)("section",{id:f,className:"rounded-2xl border border-neutral-200 bg-white",children:[(0,b.jsxs)("button",{className:"flex w-full items-center justify-between px-4 py-4 text-left",onClick:d,children:[(0,b.jsx)("span",{className:"font-semibold",children:a}),(0,b.jsx)("span",{className:"text-neutral-500",children:c?"–":"+"})]}),c&&(0,b.jsx)("div",{className:"px-4 pb-4",children:e})]})}var g=a.i(8209);function h({item:a,onClose:c}){let{add:d}=(0,g.useCart)();return a?(0,b.jsx)("div",{className:"fixed inset-0 z-50 bg-black/40 backdrop-blur-sm flex items-center justify-center",onClick:c,children:(0,b.jsxs)("div",{className:"bg-white rounded-2xl max-w-md w-full p-5 shadow-xl relative animate-fadeIn",onClick:a=>a.stopPropagation(),children:[(0,b.jsx)("button",{onClick:c,className:"absolute top-3 right-3 text-neutral-500 text-lg",children:"✕"}),(0,b.jsx)("img",{src:a.image,alt:a.name,className:"w-full h-48 object-cover rounded-xl border"}),(0,b.jsx)("h2",{className:"mt-3 text-lg font-semibold",children:a.name}),(0,b.jsx)("p",{className:"mt-2 text-sm text-neutral-600",children:a.description||"Produto selecionado Terra das Lanchas."}),(0,b.jsxs)("div",{className:"mt-3 text-lg font-semibold",children:[a.priceEur.toFixed(2)," €"]}),(0,b.jsx)("button",{onClick:function(){d({itemId:a.id,name:a.name??"Produto sem nome",priceEur:a.priceEur??0,categoryId:a.categoryId,unitLabel:a.unitLabel,volumeLiters:a.volumeLiters,image:a.image,description:a.description??""}),c()},className:"mt-4 w-full bg-black text-white py-3 rounded-xl font-medium hover:bg-neutral-800 transition",children:"Adicionar ao carrinho"})]})}):null}function i({item:a}){let{lines:c,add:f,setQty:i}=(0,g.useCart)(),j=c.find(b=>b.itemId===a.id),k=j?.qty??0,[l,m]=(0,d.useState)(null);return(0,b.jsxs)("div",{className:"flex items-center justify-between py-3",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3 pr-3",children:[a.image?(0,b.jsx)("img",{src:a.image,alt:a.name,className:"h-12 w-12 rounded-xl object-cover border border-neutral-200",onClick:()=>m(a)}):(0,b.jsx)("div",{className:"h-12 w-12 rounded-xl bg-neutral-100 border border-neutral-200"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"font-medium cursor-pointer hover:underline",onClick:()=>m(a),children:a.name}),(0,b.jsx)("div",{className:"text-xs text-neutral-500",children:[a.unitLabel,(0,e.formatEur)(a.priceEur)].filter(Boolean).join(" • ")})]})]}),0===k?(0,b.jsx)("button",{className:"rounded-lg bg-neutral-900 px-3 py-2 text-sm text-white",onClick:()=>f({itemId:a.id,name:a.name??"Produto sem nome",categoryId:a.categoryId,unitLabel:a.unitLabel,priceEur:a.priceEur,image:a.image,volumeLiters:a.volumeLiters,description:a.description}),children:"Adicionar"}):(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("button",{className:"h-9 w-9 rounded-lg border",onClick:()=>i(a.id,k-1),children:"-"}),(0,b.jsx)("div",{className:"w-6 text-center font-medium",children:k}),(0,b.jsx)("button",{className:"h-9 w-9 rounded-lg border",onClick:()=>i(a.id,k+1),children:"+"})]}),l&&(0,b.jsx)(h,{item:l,onClose:()=>m(null)})]})}function j(){let{loading:a,categories:h,items:j}=function(){let[a,b]=(0,d.useState)(!0),[c,e]=(0,d.useState)([]),[f,g]=(0,d.useState)([]),[h,i]=(0,d.useState)("");return(0,d.useEffect)(()=>{let a=!0;return(async()=>{try{let b=await fetch("/api/catalog",{cache:"no-store"}),c=await b.json();if(!a)return;e(c.categories??[]),g(c.items??[]),i(c.source??"")}catch{}finally{a&&b(!1)}})(),()=>{a=!1}},[]),{loading:a,categories:c,items:f,source:h}}(),{totalItems:k,subtotalEur:l,wantsTransport:m,transportEur:n,clear:o}=(0,g.useCart)(),p=k(),q=l(),r=n(),s=(0,d.useMemo)(()=>(h??[]).map(a=>({...a,items:(j??[]).filter(b=>b.categoryId===a.id)})),[h,j]),t=(0,d.useRef)({}),[u,v]=(0,d.useState)(""),w=h?.[0]?.id;return(0,b.jsxs)("main",{className:"pb-32 bg-neutral-50",children:[(0,b.jsxs)("div",{className:"fixed top-0 left-0 right-0 z-50 bg-neutral-100",children:[" ",(0,b.jsxs)("div",{className:"mx-auto max-w-md bg-white border-b border-neutral-200 px-4 py-3 flex items-center justify-between",children:[(0,b.jsx)("h1",{className:"text-base font-medium tracking-tight",children:"Explorar produtos"}),(0,b.jsx)("button",{onClick:()=>{o(),window.location.href="/"},className:"rounded-full bg-black text-white px-4 py-2 text-xs font-medium shadow",children:"← Voltar ao Início"})]})]}),(0,b.jsx)("div",{className:"h-16"}),(0,b.jsx)("div",{className:"sticky top-16 z-10 bg-white/90 backdrop-blur border-b border-neutral-200",children:(0,b.jsxs)("div",{className:"mx-auto max-w-md px-4 py-4",children:[(0,b.jsx)("h2",{className:"text-sm font-medium text-neutral-800",children:"Categorias"}),(0,b.jsx)("div",{className:"mt-3 flex flex-wrap gap-2",children:(h??[]).map(a=>{let c=(u||w)===a.id;return(0,b.jsx)("button",{onClick:()=>{var b;let c;return v(b=a.id),void((c=t.current[b])&&setTimeout(()=>c.scrollIntoView({behavior:"smooth",block:"start"}),80))},className:["rounded-full px-4 py-2 text-sm border transition font-medium",c?"border-black bg-black text-white":"border-neutral-200 bg-white text-neutral-700 hover:border-neutral-400"].join(" "),children:a.name},a.id)})})]})}),(0,b.jsxs)("div",{className:"mx-auto max-w-md px-4 space-y-4 mt-4",children:[a&&(0,b.jsx)("div",{className:"rounded-2xl border border-neutral-200 bg-white p-4 text-sm text-neutral-700 shadow-sm",children:"A carregar catálogo…"}),!a&&(h?.length??0)===0&&(0,b.jsxs)("div",{className:"rounded-2xl border border-neutral-200 bg-white p-4 text-sm text-red-600 shadow-sm",children:["❌ Não foi possível carregar categorias. Verifica o Google Sheet e o link em ",(0,b.jsx)("code",{children:".env.local"}),"."]}),s.map(a=>(0,b.jsx)("div",{ref:b=>{t.current[a.id]=b},className:"scroll-mt-28",children:(0,b.jsx)(f,{title:a.name,open:(u||w)===a.id,onToggle:()=>v(b=>(b||w||"")===a.id?"":a.id),anchorId:`cat-${a.id}`,children:0===a.items.length?(0,b.jsx)("p",{className:"text-sm text-neutral-500",children:"Sem produtos nesta categoria."}):(0,b.jsx)("div",{className:"divide-y divide-neutral-100",children:a.items.map(a=>(0,b.jsx)(i,{item:a},a.id))})})},a.id))]}),p>0&&(0,b.jsx)("div",{className:"fixed bottom-0 left-0 right-0 mx-auto max-w-md border-t bg-white p-4 shadow-lg",children:(0,b.jsxs)("div",{className:"flex items-start justify-between gap-3",children:[(0,b.jsxs)("div",{className:"text-sm text-neutral-700",children:[(0,b.jsxs)("div",{className:"font-medium",children:[p," ",1===p?"item":"itens"," no carrinho"]}),(0,b.jsxs)("div",{className:"text-xs mt-1",children:["Subtotal: ",(0,b.jsx)("span",{className:"font-semibold",children:(0,e.formatEur)(q)})]}),m&&(0,b.jsxs)("div",{className:"text-xs text-neutral-600",children:["Transporte (estimado):"," ",(0,b.jsx)("span",{className:"font-semibold",children:(0,e.formatEur)(r)})]})]}),(0,b.jsx)(c.default,{href:"/review",className:"rounded-full bg-black px-5 py-3 text-sm text-white font-medium shadow hover:bg-neutral-800 transition",children:"Finalizar reserva"})]})})]})}a.s(["default",()=>j],3967)}];

//# sourceMappingURL=%5Broot-of-the-server%5D__e57c3aa2._.js.map